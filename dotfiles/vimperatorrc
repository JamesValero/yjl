colorscheme vimPgray

set defsearch=g
set guioptions=rb

" Remove all key mappings
mapclear

map <F8> :set guioptions!=B<CR>
map <F9> :set guioptions!=m<CR>
map <F10> :set guioptions!=T<CR>

" I hate when I want to press <C-w> but I hit q instead
map <C-q> <Nop>

" Clean up all auto commands
:autocmd!

:js << EOF
switch (liberator.profileName) {
	case 'Normal':
		// Enter passthrough mode automatically in Gmail, Reader
		liberator.execute('autocmd LocationChange .* js modes.passAllKeys = /(mail\\.google\\.com|www\\.google\\.com\\/reader\\/)/.test(buffer.URL)');

		// Get my damn focus back
		liberator.execute('autocmd PageLoad (www\\\\.youtube|groups.google)\\\\.com :normal <Esc>');

		// Auto reload
		liberator.execute('autocmd PageLoad tw\\\\.finance\\\\.yahoo.com\\\\/pf\\\\/mypf js (function(){var t=getBrowser().tabs[<tab>-1];if (!t.pinned) getBrowser().pinTab(t);window.setTimeout(function(){getBrowser().reloadTab(t)},60000)})()');

		// Auto-pin
		liberator.execute('autocmd PageLoad listen.grooveshark.com js if(!getBrowser().mCurrentTab.pinned) getBrowser().pinTab(getBrowser().mCurrentTab);');

		// Auto-queue YouTube video for downloading
		liberator.execute('map <S-q> :js (function(){var href=getBrowser().contentDocument.location.href; if(href.indexOf("youtube.com")>=0) {var m=/v=([-_a-zA-Z0-9]+)/.exec(href);if(m) {io.system(\'echo "\'+href+\'" \\> ~/Videos/livibetter/queue/\'+m[1]); commandline.echo(m[1]+" queued.");}};})()<CR>');
		break;
	case 'Test':
		// Make command line red
		for ([k, v] in Iterator(highlight)) {
			highlight.set(k, highlight.get(k).value.replace('background: #333', 'background: #633'));
			}
		// Source special config
		io.source('~/.vimperator-Test.rc', false);
		break;
	}
EOF
